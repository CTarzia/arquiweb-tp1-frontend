{"ast":null,"code":"import _defineProperty from\"/home/widergy/Documents/Guido/UBA/arqweb/verLaCartaFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/widergy/Documents/Guido/UBA/arqweb/verLaCartaFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/widergy/Documents/Guido/UBA/arqweb/verLaCartaFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useParams}from\"react-router\";import{useLocation}from\"react-router-dom\";import GoBackButton from\"../../components/GoBack\";import{apiGet,apiPost}from\"../../utils/services\";import{ROUTES}from\"../../constants/routes\";import styles from\"./styles.module.scss\";import PostOrder from\"./components/PostOrder\";import{Typography}from\"@mui/material\";var CreateOrder=function CreateOrder(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),restaurantName=_useState2[0],setRestaurantName=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),statusError=_useState4[0],setStatusError=_useState4[1];var _useState5=useState({}),_useState6=_slicedToArray(_useState5,2),order=_useState6[0],setOrder=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),restaurantLoading=_useState8[0],setRestaurantLoading=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),orderLoading=_useState10[0],setOrderLoading=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),orderTaken=_useState12[0],setOrderTaken=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),orderStatus=_useState14[0],setOrderStatus=_useState14[1];var _useParams=useParams(),restaurantId=_useParams.id;var search=useLocation().search;var tableNumber=new URLSearchParams(search).get('mesa');useEffect(function(){fetch(\"http://localhost:8080/restaurantes/\".concat(restaurantId)).then(function(res){return res.json();}).then(function(json){if(json.status===404){setStatusError(true);setRestaurantName(\"Su restaurante no ha sido encontrado.\");}else{setRestaurantName(json.name);setRestaurantLoading(true);}});fetch(\"http://localhost:8080/mesas/\".concat(restaurantId,\"/\").concat(tableNumber)).then(function(res){return res.json();}).then(function(json){console.log(orderTaken);if(json.status){setOrderTaken(json.status);}});},[]);var handleOnInputChange=function handleOnInputChange(evt){setOrder(_objectSpread(_objectSpread({},order),{},_defineProperty({},evt.target.name,evt.target.value)));};var handleSubmit=function handleSubmit(evt){evt.preventDefault();setOrderLoading(false);if(!orderTaken){var type=tableNumber?\"table\":\"client\";var orderToSend=order;if(tableNumber){orderToSend=_objectSpread(_objectSpread({},order),{},{tableNumber:tableNumber});};console.log(typeof orderTaken);fetch(\"http://localhost:8080/orders/\".concat(type,\"/\").concat(restaurantId),{method:\"POST\",body:JSON.stringify(orderToSend),headers:{\"Content-Type\":\"application/json\"}}).then(function(res){return res.json();}).then(function(json){setOrderLoading(true);if(tableNumber){window.alert(\"Su pedido ha sido enviado.\");}else{window.alert(\"Su pedido ha sido enviado. Su n\\xFAmero de pedido es: \".concat(json,\".\"));}});fetch(\"http://localhost:8080/mesas/\".concat(restaurantId,\"/\").concat(tableNumber,\"/status\"),{method:\"PUT\",body:JSON.stringify({}),headers:{\"Content-Type\":\"application/json\"}});}else{setOrderLoading(true);window.alert(\"no puede realizar mas de un pedido\");}window.location.reload();};return!statusError?restaurantLoading?orderLoading?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:styles.titleContainer},/*#__PURE__*/React.createElement(Typography,{variant:\"h3\",component:\"h1\"},restaurantName),/*#__PURE__*/React.createElement(GoBackButton,{route:ROUTES.HOME})),/*#__PURE__*/React.createElement(PostOrder,{handleSubmit:handleSubmit,handleOnInputChange:handleOnInputChange,tableNumber:tableNumber})):/*#__PURE__*/React.createElement(\"p\",null,\"Enviando su pedido.\"):/*#__PURE__*/React.createElement(\"p\",null,\"Recuperando informaci\\xF3n del restaurante.\"):/*#__PURE__*/React.createElement(\"p\",null,\"Ha ocurrido un error.\");};export default CreateOrder;","map":{"version":3,"sources":["/home/widergy/Documents/Guido/UBA/arqweb/verLaCartaFront/src/screens/CreateOrder/index.js"],"names":["React","useState","useEffect","useParams","useLocation","GoBackButton","apiGet","apiPost","ROUTES","styles","PostOrder","Typography","CreateOrder","restaurantName","setRestaurantName","statusError","setStatusError","order","setOrder","restaurantLoading","setRestaurantLoading","orderLoading","setOrderLoading","orderTaken","setOrderTaken","orderStatus","setOrderStatus","restaurantId","id","search","tableNumber","URLSearchParams","get","fetch","then","res","json","status","name","console","log","handleOnInputChange","evt","target","value","handleSubmit","preventDefault","type","orderToSend","method","body","JSON","stringify","headers","window","alert","location","reload","titleContainer","HOME"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router\";\nimport { useLocation } from \"react-router-dom\";\n\nimport GoBackButton from \"../../components/GoBack\";\nimport { apiGet, apiPost } from \"../../utils/services\";\nimport { ROUTES } from \"../../constants/routes\";\n\nimport styles from \"./styles.module.scss\";\nimport PostOrder from \"./components/PostOrder\";\nimport { Typography } from \"@mui/material\";\n\nconst CreateOrder = () => {\n\tconst [restaurantName, setRestaurantName] = useState();\n\tconst [statusError, setStatusError] = useState(false);\n\tconst [order, setOrder] = useState({});\n\tconst [restaurantLoading, setRestaurantLoading] = useState(false);\n\tconst [orderLoading, setOrderLoading] = useState(true);\n\tconst [orderTaken, setOrderTaken] = useState(false);\n\tconst [orderStatus, setOrderStatus] = useState();\n\n\tconst { id: restaurantId } = useParams();\n\tconst search = useLocation().search;\n\tconst tableNumber = new URLSearchParams(search).get('mesa');\n\n\n\tuseEffect(() => {\n\t\tfetch(`http://localhost:8080/restaurantes/${restaurantId}`)\n\t\t.then((res) => res.json())\n\t\t.then((json) => {\n\t\t\tif (json.status === 404) {\n\t\t\t\tsetStatusError(true);\n\t\t\t\tsetRestaurantName(\"Su restaurante no ha sido encontrado.\");\n\t\t\t} else {\n\t\t\t\tsetRestaurantName(json.name);\n\t\t\t\tsetRestaurantLoading(true)\n\t\t\t}\n\t\t});\n\t\tfetch(`http://localhost:8080/mesas/${restaurantId}/${tableNumber}`)\n\t\t.then((res) => res.json())\n\t\t.then((json) => {\n\t\t\tconsole.log(orderTaken);\n\t\t\tif (json.status) {\n\t\t\t\tsetOrderTaken(json.status);\n\t\t\t}\n\t\t});\n\t}, []);\n\n\tconst handleOnInputChange = (evt) => {\n\t\tsetOrder({ ...order, [evt.target.name]: evt.target.value });\n\t};\n\n\tconst handleSubmit = (evt) => {\n\t\tevt.preventDefault()\n\t\tsetOrderLoading(false)\n\n\t\tif(!orderTaken){\n\t\t\tconst type = (tableNumber) ? (\"table\") : (\"client\")\n\t\t\tlet orderToSend = order\n\t\t\tif (tableNumber) {\n\t\t\t\torderToSend = { ...order, tableNumber }\n\t\t\t};\n\t\t\tconsole.log(typeof(orderTaken));\n\t\t\tfetch(`http://localhost:8080/orders/${type}/${restaurantId}`, {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tbody: JSON.stringify(orderToSend),\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t},\n\t\t\t})\n\t\t\t.then((res) => res.json())\n\t\t\t.then((json) => {\n\t\t\t\tsetOrderLoading(true)\n\t\t\t\tif (tableNumber) {\n\t\t\t\t\twindow.alert(`Su pedido ha sido enviado.`);\n\t\t\t\t} else {\n\t\t\t\t\twindow.alert(`Su pedido ha sido enviado. Su número de pedido es: ${json}.`);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfetch(`http://localhost:8080/mesas/${restaurantId}/${tableNumber}/status`, {\n\t\t\t\tmethod: \"PUT\",\n\t\t\t\tbody: JSON.stringify({}),\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t},\n\t\t\t});\n\t\t}else{\n\t\t\tsetOrderLoading(true);\n\t\t\twindow.alert(`no puede realizar mas de un pedido`);\n\t\t}\n\t\twindow.location.reload();\n\t};\n\n\treturn (\n\t\t!statusError ? (\n\t\t\trestaurantLoading ? (\n\t\t\t\torderLoading ? (\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div className={styles.titleContainer}>\n\t\t\t\t\t\t\t<Typography variant=\"h3\" component=\"h1\">{restaurantName}</Typography>\n\t\t\t\t\t\t\t<GoBackButton route={ROUTES.HOME} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<PostOrder\n\t\t\t\t\t\t\thandleSubmit={handleSubmit}\n\t\t\t\t\t\t\thandleOnInputChange={handleOnInputChange}\n\t\t\t\t\t\t\ttableNumber={tableNumber}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\n\t\t\t\t) : (<p>Enviando su pedido.</p>)\n\n\t\t\t) : (\n\t\t\t\t<p>Recuperando información del restaurante.</p>\n\t\t\t)\n\t\t) : (\n\t\t\t<p>Ha ocurrido un error.</p>\n\t\t)\n\n\n\t);\n};\nexport default CreateOrder;"]},"metadata":{},"sourceType":"module"}