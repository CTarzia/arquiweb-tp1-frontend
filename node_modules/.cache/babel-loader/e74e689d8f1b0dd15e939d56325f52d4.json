{"ast":null,"code":"import _defineProperty from \"/home/chiara/repos/arquiweb-tp1/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/home/chiara/repos/arquiweb-tp1/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/home/chiara/repos/arquiweb-tp1/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/home/chiara/repos/arquiweb-tp1/react-frontend/src/screens/RestaurantManagement/index.js\";\n\nimport React, { useContext, useEffect, useState } from \"react\";\nimport { CardMedia } from \"@mui/material\";\nimport PublicTopbar from \"../../components/PublicTopbar\";\nimport { UserContext } from \"../../context\";\nimport { ROUTES } from \"../../constants/routes\";\nimport GeneralInformation from \"./components/GeneralInformation\";\nimport UpdateAddressInformationDialog from \"./components/UpdateAddressInformationDialog\";\nimport UpdateGeneralInformationDialog from \"./components/UpdateGeneralInformationDialog\";\nimport styles from \"./styles.module.scss\";\n\nvar RestaurantManagment = function RestaurantManagment(_ref) {\n  var history = _ref.history;\n\n  var _useContext = useContext(UserContext),\n      userId = _useContext.userId,\n      restaurantId = _useContext.restaurantId,\n      restaurant = _useContext.restaurant,\n      setRestaurant = _useContext.setRestaurant;\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      generalDialogOpen = _useState2[0],\n      setGeneralDialogOpen = _useState2[1];\n\n  var _useState3 = useState(),\n      _useState4 = _slicedToArray(_useState3, 2),\n      addressDialogOpen = _useState4[0],\n      setAddressDialogOpen = _useState4[1];\n\n  var _useState5 = useState({\n    name: restaurant.name,\n    workingHours: restaurant.workingHours,\n    phoneNumber: restaurant.phoneNumber,\n    latitude: restaurant.latitude,\n    longitude: restaurant.longitude\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      values = _useState6[0],\n      setValues = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      loading = _useState8[0],\n      setLoading = _useState8[1];\n\n  var _useState9 = useState(),\n      _useState10 = _slicedToArray(_useState9, 2),\n      menuUrl = _useState10[0],\n      setMenuUrl = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      showMenu = _useState12[0],\n      setShowMenu = _useState12[1];\n\n  useEffect(function () {\n    if (!userId || !restaurantId) {\n      history.push(ROUTES.LOGIN);\n    }\n\n    fetch(\"https://ver-la-carta.herokuapp.com/carta/\".concat(restaurantId)).then(function (response) {\n      if (response.status === 404) {\n        return \"error\";\n      }\n\n      return response.blob();\n    }).then(function (image) {\n      console.log(image);\n\n      if (image !== \"error\") {\n        var localUrl = URL.createObjectURL(image);\n        setMenuUrl(localUrl);\n      }\n    });\n  }, []);\n\n  var handleSubmitGeneralInfo = function handleSubmitGeneralInfo(evt) {\n    evt.preventDefault();\n    setLoading(true);\n    fetch(\"https://ver-la-carta.herokuapp.com/restaurantes/\".concat(restaurantId), {\n      method: \"PUT\",\n      body: JSON.stringify(_objectSpread({}, values)),\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }).then(function (res) {\n      return res.json();\n    }).then(function (json) {\n      setRestaurant(json);\n      handleCloseDialogs(false);\n    });\n  };\n\n  var handleChange = function handleChange(e) {\n    var _e$target = e.target,\n        id = _e$target.id,\n        value = _e$target.value;\n    setValues(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, _defineProperty({}, id, value));\n    });\n  };\n\n  var handleEdit = function handleEdit(key) {\n    return setGeneralDialogOpen(key);\n  };\n\n  var handleEditAddress = function handleEditAddress() {\n    return setAddressDialogOpen(\"address\");\n  };\n\n  var handleCloseDialogs = function handleCloseDialogs() {\n    setGeneralDialogOpen(null);\n    setAddressDialogOpen(null);\n    setLoading(false);\n  };\n\n  var fileToDataUri = function fileToDataUri(file) {\n    return new Promise(function (resolve, reject) {\n      var reader = new FileReader();\n\n      reader.onload = function (event) {\n        resolve(event.target.result);\n      };\n\n      reader.readAsDataURL(file);\n    });\n  };\n\n  var onShowMenu = function onShowMenu() {\n    return setShowMenu(!showMenu);\n  };\n\n  var onUploadMenu = function onUploadMenu(file) {\n    var method = \"PUT\";\n\n    if (!menuUrl) {\n      method = \"POST\";\n    }\n\n    fileToDataUri(file).then(function (dataUri) {\n      setMenuUrl(dataUri);\n    });\n    var data = new FormData();\n    data.append(\"file\", file);\n    fetch(\"https://ver-la-carta.herokuapp.com/carta/\".concat(restaurantId), {\n      method: method,\n      body: data\n    }).then(function (res) {\n      console.log(res);\n    }).catch(setMenuUrl(null));\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.container,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 3\n    }\n  }, /*#__PURE__*/React.createElement(PublicTopbar, {\n    title: \"Gestionar: \".concat(restaurant.name),\n    history: history,\n    withGoBack: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 4\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.content,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.leftContent,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(GeneralInformation, {\n    restaurant: restaurant,\n    handleEdit: handleEdit,\n    handleEditAddress: handleEditAddress,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 6\n    }\n  }), generalDialogOpen && /*#__PURE__*/React.createElement(UpdateGeneralInformationDialog, {\n    generalDialogOpen: generalDialogOpen,\n    handleCloseDialogs: handleCloseDialogs,\n    handleSubmit: handleSubmitGeneralInfo,\n    handleChange: handleChange,\n    values: values,\n    loading: loading,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }\n  }), addressDialogOpen && /*#__PURE__*/React.createElement(UpdateAddressInformationDialog, {\n    generalDialogOpen: addressDialogOpen,\n    handleCloseDialogs: handleCloseDialogs,\n    handleSubmit: handleSubmitGeneralInfo,\n    handleChange: handleChange,\n    values: values,\n    loading: loading,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.menuContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 7\n    }\n  }, menuUrl && /*#__PURE__*/React.createElement(\"button\", {\n    className: styles.uploadImageButton,\n    onClick: onShowMenu,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 9\n    }\n  }, \"Ver carta\"), /*#__PURE__*/React.createElement(\"label\", {\n    className: styles.uploadImage,\n    for: \"upload-menu\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 8\n    }\n  }, menuUrl ? \"Editar carta\" : \"Subir carta\"), /*#__PURE__*/React.createElement(\"input\", {\n    style: {\n      display: \"none\"\n    },\n    id: \"upload-menu\",\n    name: \"upload-menu\",\n    type: \"file\",\n    onChange: function onChange(event) {\n      return onUploadMenu(event.target.files[0] || null);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 8\n    }\n  })))), /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.rightContent,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.showMenu,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 6\n    }\n  }, menuUrl && showMenu && /*#__PURE__*/React.createElement(CardMedia, {\n    component: \"img\",\n    height: \"400\",\n    width: \"400\",\n    image: menuUrl,\n    alt: \"img reastaurant\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 8\n    }\n  })))));\n};\n\nexport default RestaurantManagment;","map":{"version":3,"sources":["/home/chiara/repos/arquiweb-tp1/react-frontend/src/screens/RestaurantManagement/index.js"],"names":["React","useContext","useEffect","useState","CardMedia","PublicTopbar","UserContext","ROUTES","GeneralInformation","UpdateAddressInformationDialog","UpdateGeneralInformationDialog","styles","RestaurantManagment","history","userId","restaurantId","restaurant","setRestaurant","generalDialogOpen","setGeneralDialogOpen","addressDialogOpen","setAddressDialogOpen","name","workingHours","phoneNumber","latitude","longitude","values","setValues","loading","setLoading","menuUrl","setMenuUrl","showMenu","setShowMenu","push","LOGIN","fetch","then","response","status","blob","image","console","log","localUrl","URL","createObjectURL","handleSubmitGeneralInfo","evt","preventDefault","method","body","JSON","stringify","headers","res","json","handleCloseDialogs","handleChange","e","target","id","value","prevState","handleEdit","key","handleEditAddress","fileToDataUri","file","Promise","resolve","reject","reader","FileReader","onload","event","result","readAsDataURL","onShowMenu","onUploadMenu","dataUri","data","FormData","append","catch","container","content","leftContent","menuContainer","uploadImageButton","uploadImage","display","files","rightContent"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport { CardMedia } from \"@mui/material\";\n\nimport PublicTopbar from \"../../components/PublicTopbar\";\nimport { UserContext } from \"../../context\";\nimport { ROUTES } from \"../../constants/routes\";\n\nimport GeneralInformation from \"./components/GeneralInformation\";\nimport UpdateAddressInformationDialog from \"./components/UpdateAddressInformationDialog\";\nimport UpdateGeneralInformationDialog from \"./components/UpdateGeneralInformationDialog\";\nimport styles from \"./styles.module.scss\";\n\nconst RestaurantManagment = ({ history }) => {\n\tconst { userId, restaurantId, restaurant, setRestaurant } =\n\t\tuseContext(UserContext);\n\n\tconst [generalDialogOpen, setGeneralDialogOpen] = useState();\n\tconst [addressDialogOpen, setAddressDialogOpen] = useState();\n\tconst [values, setValues] = useState({\n\t\tname: restaurant.name,\n\t\tworkingHours: restaurant.workingHours,\n\t\tphoneNumber: restaurant.phoneNumber,\n\t\tlatitude: restaurant.latitude,\n\t\tlongitude: restaurant.longitude,\n\t});\n\tconst [loading, setLoading] = useState(false);\n\tconst [menuUrl, setMenuUrl] = useState();\n\tconst [showMenu, setShowMenu] = useState(false);\n\n\tuseEffect(() => {\n\t\tif (!userId || !restaurantId) {\n\t\t\thistory.push(ROUTES.LOGIN);\n\t\t}\n\n\t\tfetch(`https://ver-la-carta.herokuapp.com/carta/${restaurantId}`)\n\t\t\t.then((response) => {\n\t\t\t\tif (response.status === 404) {\n\t\t\t\t\treturn \"error\";\n\t\t\t\t}\n\t\t\t\treturn response.blob();\n\t\t\t})\n\t\t\t.then((image) => {\n\t\t\t\tconsole.log(image);\n\t\t\t\tif (image !== \"error\") {\n\t\t\t\t\tconst localUrl = URL.createObjectURL(image);\n\t\t\t\t\tsetMenuUrl(localUrl);\n\t\t\t\t}\n\t\t\t});\n\t}, []);\n\n\tconst handleSubmitGeneralInfo = (evt) => {\n\t\tevt.preventDefault();\n\t\tsetLoading(true);\n\t\tfetch(`https://ver-la-carta.herokuapp.com/restaurantes/${restaurantId}`, {\n\t\t\tmethod: \"PUT\",\n\t\t\tbody: JSON.stringify({ ...values }),\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t},\n\t\t})\n\t\t\t.then((res) => res.json())\n\t\t\t.then((json) => {\n\t\t\t\tsetRestaurant(json);\n\t\t\t\thandleCloseDialogs(false);\n\t\t\t});\n\t};\n\n\tconst handleChange = (e) => {\n\t\tconst { id, value } = e.target;\n\t\tsetValues((prevState) => ({\n\t\t\t...prevState,\n\t\t\t[id]: value,\n\t\t}));\n\t};\n\n\tconst handleEdit = (key) => setGeneralDialogOpen(key);\n\n\tconst handleEditAddress = () => setAddressDialogOpen(\"address\");\n\n\tconst handleCloseDialogs = () => {\n\t\tsetGeneralDialogOpen(null);\n\t\tsetAddressDialogOpen(null);\n\t\tsetLoading(false);\n\t};\n\n\tconst fileToDataUri = (file) =>\n\t\tnew Promise((resolve, reject) => {\n\t\t\tconst reader = new FileReader();\n\t\t\treader.onload = (event) => {\n\t\t\t\tresolve(event.target.result);\n\t\t\t};\n\t\t\treader.readAsDataURL(file);\n\t\t});\n\n\tconst onShowMenu = () => setShowMenu(!showMenu);\n\n\tconst onUploadMenu = (file) => {\n\t\tlet method = \"PUT\";\n\t\tif (!menuUrl) {\n\t\t\tmethod = \"POST\";\n\t\t}\n\n\t\tfileToDataUri(file).then((dataUri) => {\n\t\t\tsetMenuUrl(dataUri);\n\t\t});\n\n\t\tconst data = new FormData();\n\t\tdata.append(\"file\", file);\n\n\t\tfetch(`https://ver-la-carta.herokuapp.com/carta/${restaurantId}`, {\n\t\t\tmethod,\n\t\t\tbody: data,\n\t\t})\n\t\t\t.then((res) => {\n\t\t\t\tconsole.log(res);\n\t\t\t})\n\t\t\t.catch(setMenuUrl(null));\n\t};\n\n\treturn (\n\t\t<div className={styles.container}>\n\t\t\t<PublicTopbar\n\t\t\t\ttitle={`Gestionar: ${restaurant.name}`}\n\t\t\t\thistory={history}\n\t\t\t\twithGoBack\n\t\t\t/>\n\t\t\t<div className={styles.content}>\n\t\t\t\t<div className={styles.leftContent}>\n\t\t\t\t\t<GeneralInformation\n\t\t\t\t\t\trestaurant={restaurant}\n\t\t\t\t\t\thandleEdit={handleEdit}\n\t\t\t\t\t\thandleEditAddress={handleEditAddress}\n\t\t\t\t\t/>\n\t\t\t\t\t{generalDialogOpen && (\n\t\t\t\t\t\t<UpdateGeneralInformationDialog\n\t\t\t\t\t\t\tgeneralDialogOpen={generalDialogOpen}\n\t\t\t\t\t\t\thandleCloseDialogs={handleCloseDialogs}\n\t\t\t\t\t\t\thandleSubmit={handleSubmitGeneralInfo}\n\t\t\t\t\t\t\thandleChange={handleChange}\n\t\t\t\t\t\t\tvalues={values}\n\t\t\t\t\t\t\tloading={loading}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{addressDialogOpen && (\n\t\t\t\t\t\t<UpdateAddressInformationDialog\n\t\t\t\t\t\t\tgeneralDialogOpen={addressDialogOpen}\n\t\t\t\t\t\t\thandleCloseDialogs={handleCloseDialogs}\n\t\t\t\t\t\t\thandleSubmit={handleSubmitGeneralInfo}\n\t\t\t\t\t\t\thandleChange={handleChange}\n\t\t\t\t\t\t\tvalues={values}\n\t\t\t\t\t\t\tloading={loading}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div className={styles.menuContainer}>\n\t\t\t\t\t\t\t{menuUrl && (\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName={styles.uploadImageButton}\n\t\t\t\t\t\t\t\t\tonClick={onShowMenu}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tVer carta\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<label className={styles.uploadImage} for=\"upload-menu\">\n\t\t\t\t\t\t\t\t{menuUrl ? \"Editar carta\" : \"Subir carta\"}\n\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tstyle={{ display: \"none\" }}\n\t\t\t\t\t\t\t\tid=\"upload-menu\"\n\t\t\t\t\t\t\t\tname=\"upload-menu\"\n\t\t\t\t\t\t\t\ttype=\"file\"\n\t\t\t\t\t\t\t\tonChange={(event) =>\n\t\t\t\t\t\t\t\t\tonUploadMenu(event.target.files[0] || null)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className={styles.rightContent}>\n\t\t\t\t\t<div className={styles.showMenu}>\n\t\t\t\t\t\t{menuUrl && showMenu && (\n\t\t\t\t\t\t\t<CardMedia\n\t\t\t\t\t\t\t\tcomponent=\"img\"\n\t\t\t\t\t\t\t\theight=\"400\"\n\t\t\t\t\t\t\t\twidth=\"400\"\n\t\t\t\t\t\t\t\timage={menuUrl}\n\t\t\t\t\t\t\t\talt=\"img reastaurant\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default RestaurantManagment;\n"]},"metadata":{},"sourceType":"module"}