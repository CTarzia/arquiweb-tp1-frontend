{"ast":null,"code":"import _defineProperty from\"/home/chiara/repos/arquiweb-tp1/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/chiara/repos/arquiweb-tp1/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/chiara/repos/arquiweb-tp1/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from\"react\";import{Link}from\"react-router-dom\";import{Snackbar,Alert,CircularProgress}from\"@mui/material\";import{ROUTES}from\"../../constants/routes\";import PasswordField from\"../../components/PasswordField\";import styles from\"./styles.module.scss\";var Signup=function Signup(_ref){var history=_ref.history;var _useState=useState({username:\"\",password:\"\"}),_useState2=_slicedToArray(_useState,2),values=_useState2[0],setValues=_useState2[1];var _useState3=useState({latitude:null,longitude:null}),_useState4=_slicedToArray(_useState3,2),coordinates=_useState4[0],setCoordinates=_useState4[1];var _useState5=useState({isOpen:false,message:\"\"}),_useState6=_slicedToArray(_useState5,2),snackbarOptions=_useState6[0],setSnackbarOptions=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),loading=_useState8[0],setLoading=_useState8[1];var saveLocation=function saveLocation(pos){var _pos$coords,_pos$coords2;return setCoordinates({latitude:pos===null||pos===void 0?void 0:(_pos$coords=pos.coords)===null||_pos$coords===void 0?void 0:_pos$coords.latitude.toString(),longitude:pos===null||pos===void 0?void 0:(_pos$coords2=pos.coords)===null||_pos$coords2===void 0?void 0:_pos$coords2.longitude.toString()});};useEffect(function(){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(saveLocation);}},[]);var handleSubmit=function handleSubmit(evt){evt.preventDefault();setLoading(true);var restaurant=_objectSpread({name:\"Restaurante nuevo\"},coordinates);fetch(\"https://ver-la-carta.herokuapp.com/restaurantes/\",{method:\"POST\",body:JSON.stringify(_objectSpread({},restaurant)),headers:{\"Content-Type\":\"application/json\"}}).then(function(res){return res.json();}).then(function(json){fetch(\"https://ver-la-carta.herokuapp.com/usuarios/\",{method:\"POST\",body:JSON.stringify(_objectSpread(_objectSpread({},values),{},{restaurantId:json.id})),headers:{\"Content-Type\":\"application/json\"}}).then(function(res){return res.json();}).then(function(json){console.log(json);setSnackbarOptions({isOpen:true,message:\"Su usuario se ha creado con exito\"});setLoading(false);});});};var handleChange=function handleChange(e){var _e$target=e.target,id=_e$target.id,value=_e$target.value;setValues(function(prevState){return _objectSpread(_objectSpread({},prevState),{},_defineProperty({},id,value));});};var handleCloseSnackbar=function handleCloseSnackbar(){setSnackbarOptions({isOpen:false,message:\"Su usuario se ha creado con exito: Redirigiendo\"});history.push(ROUTES.LOGIN);};return/*#__PURE__*/React.createElement(\"div\",{className:styles.container},/*#__PURE__*/React.createElement(\"div\",{className:styles.title},/*#__PURE__*/React.createElement(\"h1\",null,\" Crear usuario \")),/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit,className:styles.form},/*#__PURE__*/React.createElement(\"div\",{className:styles.input},/*#__PURE__*/React.createElement(\"label\",{className:styles.label},\"Nombre de usuario:\"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",name:\"username\",id:\"username\",onChange:handleChange})),/*#__PURE__*/React.createElement(PasswordField,{onChangePassword:handleChange}),/*#__PURE__*/React.createElement(\"button\",{className:loading?styles.disabledButton:styles.button,onClick:handleSubmit,disabled:loading},loading?/*#__PURE__*/React.createElement(CircularProgress,{classes:{root:styles.progress}}):\"Crear usuario\"),/*#__PURE__*/React.createElement(Link,{to:ROUTES.LOGIN},/*#__PURE__*/React.createElement(\"button\",{className:styles.button},\"Iniciar Sesion\"))),/*#__PURE__*/React.createElement(Snackbar,{open:snackbarOptions.isOpen,autoHideDuration:3000,onClose:handleCloseSnackbar},/*#__PURE__*/React.createElement(Alert,{severity:\"success\",sx:{width:\"100%\"},variant:\"filled\"},snackbarOptions.message)));};export default Signup;","map":{"version":3,"sources":["/home/chiara/repos/arquiweb-tp1/react-frontend/src/screens/Signup/index.js"],"names":["React","useEffect","useState","Link","Snackbar","Alert","CircularProgress","ROUTES","PasswordField","styles","Signup","history","username","password","values","setValues","latitude","longitude","coordinates","setCoordinates","isOpen","message","snackbarOptions","setSnackbarOptions","loading","setLoading","saveLocation","pos","coords","toString","navigator","geolocation","getCurrentPosition","handleSubmit","evt","preventDefault","restaurant","name","fetch","method","body","JSON","stringify","headers","then","res","json","restaurantId","id","console","log","handleChange","e","target","value","prevState","handleCloseSnackbar","push","LOGIN","container","title","form","input","label","disabledButton","button","root","progress","width"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { Snackbar, Alert, CircularProgress } from \"@mui/material\";\n\nimport { ROUTES } from \"../../constants/routes\";\nimport PasswordField from \"../../components/PasswordField\";\n\nimport styles from \"./styles.module.scss\";\n\nconst Signup = ({ history }) => {\n\tconst [values, setValues] = useState({\n\t\tusername: \"\",\n\t\tpassword: \"\",\n\t});\n\tconst [coordinates, setCoordinates] = useState({\n\t\tlatitude: null,\n\t\tlongitude: null,\n\t});\n\tconst [snackbarOptions, setSnackbarOptions] = useState({\n\t\tisOpen: false,\n\t\tmessage: \"\",\n\t});\n\tconst [loading, setLoading] = useState(false);\n\n\tconst saveLocation = (pos) =>\n\t\tsetCoordinates({\n\t\t\tlatitude: pos?.coords?.latitude.toString(),\n\t\t\tlongitude: pos?.coords?.longitude.toString(),\n\t\t});\n\n\tuseEffect(() => {\n\t\tif (navigator.geolocation) {\n\t\t\tnavigator.geolocation.getCurrentPosition(saveLocation);\n\t\t}\n\t}, []);\n\n\tconst handleSubmit = (evt) => {\n\t\tevt.preventDefault();\n\t\tsetLoading(true);\n\n\t\tconst restaurant = {\n\t\t\tname: \"Restaurante nuevo\",\n\t\t\t...coordinates,\n\t\t};\n\n\t\tfetch(`https://ver-la-carta.herokuapp.com/restaurantes/`, {\n\t\t\tmethod: \"POST\",\n\t\t\tbody: JSON.stringify({ ...restaurant }),\n\t\t\theaders: {\n\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t},\n\t\t})\n\t\t\t.then((res) => res.json())\n\t\t\t.then((json) => {\n\t\t\t\tfetch(`https://ver-la-carta.herokuapp.com/usuarios/`, {\n\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\tbody: JSON.stringify({ ...values, restaurantId: json.id }),\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\t\t.then((res) => res.json())\n\t\t\t\t\t.then((json) => {\n\t\t\t\t\t\tconsole.log(json);\n\t\t\t\t\t\tsetSnackbarOptions({\n\t\t\t\t\t\t\tisOpen: true,\n\t\t\t\t\t\t\tmessage: \"Su usuario se ha creado con exito\",\n\t\t\t\t\t\t});\n\t\t\t\t\t\tsetLoading(false);\n\t\t\t\t\t});\n\t\t\t});\n\t};\n\n\tconst handleChange = (e) => {\n\t\tconst { id, value } = e.target;\n\t\tsetValues((prevState) => ({\n\t\t\t...prevState,\n\t\t\t[id]: value,\n\t\t}));\n\t};\n\n\tconst handleCloseSnackbar = () => {\n\t\tsetSnackbarOptions({\n\t\t\tisOpen: false,\n\t\t\tmessage: \"Su usuario se ha creado con exito: Redirigiendo\",\n\t\t});\n\t\thistory.push(ROUTES.LOGIN);\n\t};\n\n\treturn (\n\t\t<div className={styles.container}>\n\t\t\t<div className={styles.title}>\n\t\t\t\t<h1> Crear usuario </h1>\n\t\t\t</div>\n\n\t\t\t<form onSubmit={handleSubmit} className={styles.form}>\n\t\t\t\t<div className={styles.input}>\n\t\t\t\t\t<label className={styles.label}>Nombre de usuario:</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tname=\"username\"\n\t\t\t\t\t\tid=\"username\"\n\t\t\t\t\t\tonChange={handleChange}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<PasswordField onChangePassword={handleChange} />\n\n\t\t\t\t<button\n\t\t\t\t\tclassName={loading ? styles.disabledButton : styles.button}\n\t\t\t\t\tonClick={handleSubmit}\n\t\t\t\t\tdisabled={loading}\n\t\t\t\t>\n\t\t\t\t\t{loading ? (\n\t\t\t\t\t\t<CircularProgress classes={{ root: styles.progress }} />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t\"Crear usuario\"\n\t\t\t\t\t)}\n\t\t\t\t</button>\n\n\t\t\t\t<Link to={ROUTES.LOGIN}>\n\t\t\t\t\t<button className={styles.button}>Iniciar Sesion</button>\n\t\t\t\t</Link>\n\t\t\t</form>\n\t\t\t<Snackbar\n\t\t\t\topen={snackbarOptions.isOpen}\n\t\t\t\tautoHideDuration={3000}\n\t\t\t\tonClose={handleCloseSnackbar}\n\t\t\t>\n\t\t\t\t<Alert severity=\"success\" sx={{ width: \"100%\" }} variant=\"filled\">\n\t\t\t\t\t{snackbarOptions.message}\n\t\t\t\t</Alert>\n\t\t\t</Snackbar>\n\t\t</div>\n\t);\n};\n\nexport default Signup;\n"]},"metadata":{},"sourceType":"module"}