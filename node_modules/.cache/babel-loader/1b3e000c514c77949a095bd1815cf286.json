{"ast":null,"code":"import _toConsumableArray from\"/home/chiara/repos/arquiweb-tp1/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/chiara/repos/arquiweb-tp1/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import DisplayImages from\"../DisplayImages\";import Grid from'@mui/material/Grid';import Button from'@mui/material/Button';import PhotoCamera from'@mui/icons-material/PhotoCamera';import styles from\"../../styles.module.scss\";var UploadImages=function UploadImages(_ref){var restaurantId=_ref.restaurantId;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),dataUri=_useState2[0],setDataUri=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),statusError=_useState4[0],setStatusError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),imagesLoading=_useState6[0],setImagesLoading=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),photos=_useState8[0],setPhotos=_useState8[1];var fileToDataUri=function fileToDataUri(file){return new Promise(function(resolve,reject){var reader=new FileReader();reader.onload=function(event){resolve(event.target.result);};reader.readAsDataURL(file);});};useEffect(function(){getImages();},[]);var _onChange=function onChange(file){if(!file){setDataUri('');return;}fileToDataUri(file).then(function(dataUri){setDataUri(dataUri);});var data=new FormData();data.append('file',file);fetch(\"https://ver-la-carta.herokuapp.com/imagen/\".concat(restaurantId),{method:\"POST\",body:data}).then(function(res){return res.json();}).then(function(data){getImages();}).catch(setPhotos([]));};var getImages=function getImages(){setPhotos([]);var fetchImages=function fetchImages(imageId){fetch(\"https://ver-la-carta.herokuapp.com/imagen/\".concat(imageId)).then(function(response){return response.blob();}).then(function(image){// Create a local URL of that image\nvar localUrl=URL.createObjectURL(image);setPhotos(function(photos){return[].concat(_toConsumableArray(photos),[{url:localUrl,id:imageId}]);});setImagesLoading(true);});};fetch(\"https://ver-la-carta.herokuapp.com/imagen/resto/\".concat(restaurantId)).then(function(response){return response.json();}).then(function(imageIds){imageIds.map(fetchImages);});};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"label\",{className:styles.uploadImage,htmlFor:\"upload-photo\"},\"A\\xF1adir imagen\"),/*#__PURE__*/React.createElement(\"input\",{style:{display:'none'},id:\"upload-photo\",name:\"upload-photo\",type:\"file\",onChange:function onChange(event){return _onChange(event.target.files[0]||null);}}),imagesLoading?/*#__PURE__*/React.createElement(Grid,{container:true,spacing:2},photos.map(function(img){return/*#__PURE__*/React.createElement(Grid,{item:true,xs:4},/*#__PURE__*/React.createElement(DisplayImages,{img:img,onDelete:getImages}));})):/*#__PURE__*/React.createElement(\"div\",null,\"Recuperando im\\xE1genes de su restaurante...\"));};export default UploadImages;","map":{"version":3,"sources":["/home/chiara/repos/arquiweb-tp1/react-frontend/src/screens/RestaurantManagement/oldComponents/UploadImages/index.js"],"names":["React","useState","useEffect","DisplayImages","Grid","Button","PhotoCamera","styles","UploadImages","restaurantId","dataUri","setDataUri","statusError","setStatusError","imagesLoading","setImagesLoading","photos","setPhotos","fileToDataUri","file","Promise","resolve","reject","reader","FileReader","onload","event","target","result","readAsDataURL","getImages","onChange","then","data","FormData","append","fetch","method","body","res","json","catch","fetchImages","imageId","response","blob","image","localUrl","URL","createObjectURL","url","id","imageIds","map","uploadImage","display","files","img"],"mappings":"kVAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,aAAP,KAA0B,kBAA1B,CACA,MAAOC,CAAAA,IAAP,KAAiB,oBAAjB,CACA,MAAOC,CAAAA,MAAP,KAAmB,sBAAnB,CACA,MAAOC,CAAAA,WAAP,KAAwB,iCAAxB,CAEA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CAGA,GAAMC,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,MAEf,IADFC,CAAAA,YACE,MADFA,YACE,CAEF,cAA8BR,QAAQ,CAAC,EAAD,CAAtC,wCAAOS,OAAP,eAAgBC,UAAhB,eACA,eAAsCV,QAAQ,CAAC,KAAD,CAA9C,yCAAOW,WAAP,eAAoBC,cAApB,eACA,eAA0CZ,QAAQ,CAAC,KAAD,CAAlD,yCAAOa,aAAP,eAAsBC,gBAAtB,eACA,eAA4Bd,QAAQ,CAAC,EAAD,CAApC,yCAAOe,MAAP,eAAeC,SAAf,eAEA,GAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACC,IAAD,QAAU,IAAIC,CAAAA,OAAJ,CAAY,SAACC,OAAD,CAAUC,MAAV,CAAqB,CAC7D,GAAMC,CAAAA,MAAM,CAAG,GAAIC,CAAAA,UAAJ,EAAf,CACAD,MAAM,CAACE,MAAP,CAAgB,SAACC,KAAD,CAAW,CACvBL,OAAO,CAACK,KAAK,CAACC,MAAN,CAAaC,MAAd,CAAP,CACH,CAFD,CAGAL,MAAM,CAACM,aAAP,CAAqBV,IAArB,EACH,CAN+B,CAAV,EAAtB,CAQAjB,SAAS,CAAC,UAAM,CACZ4B,SAAS,GACZ,CAFQ,CAEN,EAFM,CAAT,CAKA,GAAMC,CAAAA,SAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACZ,IAAD,CAAU,CAEvB,GAAI,CAACA,IAAL,CAAW,CACPR,UAAU,CAAC,EAAD,CAAV,CACA,OACH,CAEDO,aAAa,CAACC,IAAD,CAAb,CACKa,IADL,CACU,SAAAtB,OAAO,CAAI,CACbC,UAAU,CAACD,OAAD,CAAV,CACH,CAHL,EAKA,GAAMuB,CAAAA,IAAI,CAAG,GAAIC,CAAAA,QAAJ,EAAb,CACAD,IAAI,CAACE,MAAL,CAAY,MAAZ,CAAoBhB,IAApB,EAEAiB,KAAK,qDAA8C3B,YAA9C,EAA8D,CAC/D4B,MAAM,CAAE,MADuD,CAE/DC,IAAI,CAAEL,IAFyD,CAA9D,CAAL,CAIKD,IAJL,CAIU,SAAAO,GAAG,QAAIA,CAAAA,GAAG,CAACC,IAAJ,EAAJ,EAJb,EAKKR,IALL,CAKU,SAAAC,IAAI,CAAI,CACVH,SAAS,GACZ,CAPL,EAQKW,KARL,CAQWxB,SAAS,CAAC,EAAD,CARpB,EASH,CAxBD,CA0BA,GAAMa,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACpBb,SAAS,CAAC,EAAD,CAAT,CACA,GAAMyB,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAAAC,OAAO,CAAI,CAC3BP,KAAK,qDAA8CO,OAA9C,EAAL,CACKX,IADL,CACU,SAAAY,QAAQ,QAAIA,CAAAA,QAAQ,CAACC,IAAT,EAAJ,EADlB,EAEKb,IAFL,CAEU,SAAAc,KAAK,CAAI,CACX;AACA,GAAMC,CAAAA,QAAQ,CAAGC,GAAG,CAACC,eAAJ,CAAoBH,KAApB,CAAjB,CACA7B,SAAS,CAAC,SAAAD,MAAM,qCAAQA,MAAR,GAAgB,CAAEkC,GAAG,CAAEH,QAAP,CAAiBI,EAAE,CAAER,OAArB,CAAhB,IAAP,CAAT,CACA5B,gBAAgB,CAAC,IAAD,CAAhB,CACH,CAPL,EAQH,CATD,CAWAqB,KAAK,2DAAoD3B,YAApD,EAAL,CACKuB,IADL,CACU,SAAAY,QAAQ,QAAIA,CAAAA,QAAQ,CAACJ,IAAT,EAAJ,EADlB,EAEKR,IAFL,CAEU,SAAAoB,QAAQ,CAAI,CACdA,QAAQ,CAACC,GAAT,CAAaX,WAAb,EACH,CAJL,EAKH,CAlBD,CAoBA,mBAEI,4CAEI,6BAAO,SAAS,CAAEnC,MAAM,CAAC+C,WAAzB,CAAsC,OAAO,CAAC,cAA9C,qBAFJ,cAKI,6BACI,KAAK,CAAE,CAAEC,OAAO,CAAE,MAAX,CADX,CAEI,EAAE,CAAC,cAFP,CAGI,IAAI,CAAC,cAHT,CAII,IAAI,CAAC,MAJT,CAKI,QAAQ,CAAE,kBAAC7B,KAAD,QAAWK,CAAAA,SAAQ,CAACL,KAAK,CAACC,MAAN,CAAa6B,KAAb,CAAmB,CAAnB,GAAyB,IAA1B,CAAnB,EALd,EALJ,CAcK1C,aAAa,cACV,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,OAAO,CAAE,CAAzB,EACKE,MAAM,CAACqC,GAAP,CAAW,SAAAI,GAAG,qBACX,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,CAAf,eACI,oBAAC,aAAD,EACI,GAAG,CAAEA,GADT,CAEI,QAAQ,CAAE3B,SAFd,EADJ,CADW,EAAd,CADL,CADU,cAYV,8EA1BR,CAFJ,CAkCH,CAtGD,CAwGA,cAAetB,CAAAA,YAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport DisplayImages from \"../DisplayImages\";\nimport Grid from '@mui/material/Grid';\nimport Button from '@mui/material/Button';\nimport PhotoCamera from '@mui/icons-material/PhotoCamera';\n\nimport styles from \"../../styles.module.scss\";\n\n\nconst UploadImages = ({\n    restaurantId\n}) => {\n\n    const [dataUri, setDataUri] = useState('');\n    const [statusError, setStatusError] = useState(false);\n    const [imagesLoading, setImagesLoading] = useState(false);\n    const [photos, setPhotos] = useState([]);\n\n    const fileToDataUri = (file) => new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onload = (event) => {\n            resolve(event.target.result)\n        };\n        reader.readAsDataURL(file);\n    })\n\n    useEffect(() => {\n        getImages()\n    }, []);\n\n\n    const onChange = (file) => {\n\n        if (!file) {\n            setDataUri('');\n            return;\n        }\n\n        fileToDataUri(file)\n            .then(dataUri => {\n                setDataUri(dataUri);\n            });\n\n        const data = new FormData()\n        data.append('file', file)\n\n        fetch(`https://ver-la-carta.herokuapp.com/imagen/${restaurantId}`, {\n            method: \"POST\",\n            body: data\n        })\n            .then(res => res.json())\n            .then(data => {\n                getImages()\n            })\n            .catch(setPhotos([]));\n    }\n\n    const getImages = () => {\n        setPhotos([])\n        const fetchImages = imageId => {\n            fetch(`https://ver-la-carta.herokuapp.com/imagen/${imageId}`)\n                .then(response => response.blob())\n                .then(image => {\n                    // Create a local URL of that image\n                    const localUrl = URL.createObjectURL(image);\n                    setPhotos(photos => [...photos, { url: localUrl, id: imageId }]);\n                    setImagesLoading(true);\n                });\n        }\n\n        fetch(`https://ver-la-carta.herokuapp.com/imagen/resto/${restaurantId}`)\n            .then(response => response.json())\n            .then(imageIds => {\n                imageIds.map(fetchImages)\n            });\n    }\n\n    return (\n\n        <div>\n\n            <label className={styles.uploadImage} htmlFor=\"upload-photo\">\n                Añadir imagen\n            </label>\n            <input\n                style={{ display: 'none' }}\n                id=\"upload-photo\"\n                name=\"upload-photo\"\n                type=\"file\"\n                onChange={(event) => onChange(event.target.files[0] || null)}\n            />\n\n\n            {imagesLoading ? (\n                <Grid container spacing={2}>\n                    {photos.map(img => (\n                        <Grid item xs={4}>\n                            <DisplayImages\n                                img={img}\n                                onDelete={getImages}\n                            />\n                        </Grid>\n                    ))}\n                </Grid>\n            ) : (\n                <div>Recuperando imágenes de su restaurante...</div>\n            )}\n\n        </div>\n\n    );\n};\n\nexport default UploadImages"]},"metadata":{},"sourceType":"module"}