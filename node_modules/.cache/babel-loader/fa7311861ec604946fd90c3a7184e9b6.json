{"ast":null,"code":"import _defineProperty from\"/home/chiara/repos/arquiweb-tp1/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/chiara/repos/arquiweb-tp1/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"/home/chiara/repos/arquiweb-tp1/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useParams}from\"react-router\";import{useLocation}from\"react-router-dom\";import GoBackButton from\"../../components/GoBack\";import{ROUTES}from\"../../constants/routes\";import styles from\"./styles.module.scss\";import PostOrder from\"./components/PostOrder\";import{Typography}from\"@mui/material\";var CreateOrder=function CreateOrder(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),order=_useState2[0],setOrder=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),orderLoading=_useState4[0],setOrderLoading=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),orderTaken=_useState6[0],setOrderTaken=_useState6[1];var _useParams=useParams(),restaurantId=_useParams.id;var search=useLocation().search;var tableNumber=new URLSearchParams(search).get(\"mesa\");var restaurantName=new URLSearchParams(search).get(\"nombre\");useEffect(function(){fetch(\"https://ver-la-carta.herokuapp.com/mesas/\".concat(restaurantId,\"/\").concat(tableNumber)).then(function(res){return res.json();}).then(function(json){console.log(orderTaken);if(json.status){setOrderTaken(json.status);}});},[]);var handleOnInputChange=function handleOnInputChange(evt){setOrder(_objectSpread(_objectSpread({},order),{},_defineProperty({},evt.target.name,evt.target.value)));};var handleSubmit=function handleSubmit(evt){evt.preventDefault();setOrderLoading(false);if(!orderTaken){var type=tableNumber?\"table\":\"client\";var orderToSend=order;if(tableNumber){orderToSend=_objectSpread(_objectSpread({},order),{},{tableNumber:tableNumber});}console.log(typeof orderTaken);fetch(\"https://ver-la-carta.herokuapp.com/orders/\".concat(type,\"/\").concat(restaurantId),{method:\"POST\",body:JSON.stringify(orderToSend),headers:{\"Content-Type\":\"application/json\"}}).then(function(res){return res.json();}).then(function(json){setOrderLoading(true);if(tableNumber){window.alert(\"Su pedido ha sido enviado.\");}else{window.alert(\"Su pedido ha sido enviado. Su n\\xFAmero de pedido es: \".concat(json,\".\"));}});fetch(\"https://ver-la-carta.herokuapp.com/mesas/\".concat(restaurantId,\"/\").concat(tableNumber,\"/status\"),{method:\"PUT\",body:JSON.stringify({}),headers:{\"Content-Type\":\"application/json\"}});}else{setOrderLoading(true);window.alert(\"no puede realizar mas de un pedido\");}window.location.reload();};return orderLoading?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:styles.titleContainer},/*#__PURE__*/React.createElement(Typography,{variant:\"h3\",component:\"h1\"},restaurantName),/*#__PURE__*/React.createElement(GoBackButton,{route:ROUTES.NEARBY_RESTAURANTS})),/*#__PURE__*/React.createElement(PostOrder,{handleSubmit:handleSubmit,handleOnInputChange:handleOnInputChange,tableNumber:tableNumber})):/*#__PURE__*/React.createElement(\"p\",null,\"Enviando su pedido.\");};export default CreateOrder;","map":{"version":3,"sources":["/home/chiara/repos/arquiweb-tp1/react-frontend/src/screens/CreateOrder/index.js"],"names":["React","useState","useEffect","useParams","useLocation","GoBackButton","ROUTES","styles","PostOrder","Typography","CreateOrder","order","setOrder","orderLoading","setOrderLoading","orderTaken","setOrderTaken","restaurantId","id","search","tableNumber","URLSearchParams","get","restaurantName","fetch","then","res","json","console","log","status","handleOnInputChange","evt","target","name","value","handleSubmit","preventDefault","type","orderToSend","method","body","JSON","stringify","headers","window","alert","location","reload","titleContainer","NEARBY_RESTAURANTS"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router\";\nimport { useLocation } from \"react-router-dom\";\n\nimport GoBackButton from \"../../components/GoBack\";\nimport { ROUTES } from \"../../constants/routes\";\n\nimport styles from \"./styles.module.scss\";\nimport PostOrder from \"./components/PostOrder\";\nimport { Typography } from \"@mui/material\";\n\nconst CreateOrder = () => {\n\tconst [order, setOrder] = useState({});\n\n\tconst [orderLoading, setOrderLoading] = useState(true);\n\tconst [orderTaken, setOrderTaken] = useState(false);\n\n\tconst { id: restaurantId } = useParams();\n\tconst search = useLocation().search;\n\tconst tableNumber = new URLSearchParams(search).get(\"mesa\");\n\tconst restaurantName = new URLSearchParams(search).get(\"nombre\");\n\n\tuseEffect(() => {\n\t\tfetch(\n\t\t\t`https://ver-la-carta.herokuapp.com/mesas/${restaurantId}/${tableNumber}`\n\t\t)\n\t\t\t.then((res) => res.json())\n\t\t\t.then((json) => {\n\t\t\t\tconsole.log(orderTaken);\n\t\t\t\tif (json.status) {\n\t\t\t\t\tsetOrderTaken(json.status);\n\t\t\t\t}\n\t\t\t});\n\t}, []);\n\n\tconst handleOnInputChange = (evt) => {\n\t\tsetOrder({ ...order, [evt.target.name]: evt.target.value });\n\t};\n\n\tconst handleSubmit = (evt) => {\n\t\tevt.preventDefault();\n\t\tsetOrderLoading(false);\n\n\t\tif (!orderTaken) {\n\t\t\tconst type = tableNumber ? \"table\" : \"client\";\n\t\t\tlet orderToSend = order;\n\t\t\tif (tableNumber) {\n\t\t\t\torderToSend = { ...order, tableNumber };\n\t\t\t}\n\t\t\tconsole.log(typeof orderTaken);\n\t\t\tfetch(\n\t\t\t\t`https://ver-la-carta.herokuapp.com/orders/${type}/${restaurantId}`,\n\t\t\t\t{\n\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\tbody: JSON.stringify(orderToSend),\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t)\n\t\t\t\t.then((res) => res.json())\n\t\t\t\t.then((json) => {\n\t\t\t\t\tsetOrderLoading(true);\n\t\t\t\t\tif (tableNumber) {\n\t\t\t\t\t\twindow.alert(`Su pedido ha sido enviado.`);\n\t\t\t\t\t} else {\n\t\t\t\t\t\twindow.alert(\n\t\t\t\t\t\t\t`Su pedido ha sido enviado. Su n√∫mero de pedido es: ${json}.`\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\tfetch(\n\t\t\t\t`https://ver-la-carta.herokuapp.com/mesas/${restaurantId}/${tableNumber}/status`,\n\t\t\t\t{\n\t\t\t\t\tmethod: \"PUT\",\n\t\t\t\t\tbody: JSON.stringify({}),\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t);\n\t\t} else {\n\t\t\tsetOrderLoading(true);\n\t\t\twindow.alert(`no puede realizar mas de un pedido`);\n\t\t}\n\t\twindow.location.reload();\n\t};\n\n\treturn orderLoading ? (\n\t\t<div>\n\t\t\t<div className={styles.titleContainer}>\n\t\t\t\t<Typography variant=\"h3\" component=\"h1\">\n\t\t\t\t\t{restaurantName}\n\t\t\t\t</Typography>\n\t\t\t\t<GoBackButton route={ROUTES.NEARBY_RESTAURANTS} />\n\t\t\t</div>\n\t\t\t<PostOrder\n\t\t\t\thandleSubmit={handleSubmit}\n\t\t\t\thandleOnInputChange={handleOnInputChange}\n\t\t\t\ttableNumber={tableNumber}\n\t\t\t/>\n\t\t</div>\n\t) : (\n\t\t<p>Enviando su pedido.</p>\n\t);\n};\nexport default CreateOrder;\n"]},"metadata":{},"sourceType":"module"}