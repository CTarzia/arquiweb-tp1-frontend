{"ast":null,"code":"import _toConsumableArray from\"/home/chiara/repos/arquiweb-tp1/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/home/chiara/repos/arquiweb-tp1/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import DisplayImages from\"../DisplayImages\";import Grid from'@mui/material/Grid';import Button from'@mui/material/Button';import PhotoCamera from'@mui/icons-material/PhotoCamera';var UploadImages=function UploadImages(_ref){var restaurantId=_ref.restaurantId;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),dataUri=_useState2[0],setDataUri=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),statusError=_useState4[0],setStatusError=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),imagesLoading=_useState6[0],setImagesLoading=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),photos=_useState8[0],setPhotos=_useState8[1];var fileToDataUri=function fileToDataUri(file){return new Promise(function(resolve,reject){var reader=new FileReader();reader.onload=function(event){resolve(event.target.result);};reader.readAsDataURL(file);});};useEffect(function(){var fetchImages=function fetchImages(imageId){fetch(\"https://ver-la-carta.herokuapp.com/imagen/\".concat(imageId)).then(function(response){return response.blob();}).then(function(image){// Create a local URL of that image\nvar localUrl=URL.createObjectURL(image);setPhotos(function(photos){return[].concat(_toConsumableArray(photos),[{url:localUrl,id:imageId}]);});setImagesLoading(true);});};fetch(\"https://ver-la-carta.herokuapp.com/imagen/resto/\".concat(restaurantId)).then(function(response){return response.json();}).then(function(imageIds){imageIds.map(fetchImages);});},[]);var _onChange=function onChange(file){if(!file){setDataUri('');return;}fileToDataUri(file).then(function(dataUri){setDataUri(dataUri);});var data=new FormData();data.append('file',file);fetch(\"https://ver-la-carta.herokuapp.com/imagen/\".concat(restaurantId),{method:\"POST\",body:data}).then(function(res){return res.json();}).then(function(data){});window.location.reload();};return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"upload-photo\"},/*#__PURE__*/React.createElement(\"input\",{style:{display:'none'},id:\"upload-photo\",name:\"upload-photo\",type:\"file\",onChange:function onChange(event){return _onChange(event.target.files[0]||null);}}),/*#__PURE__*/React.createElement(Button,{variant:\"contained\",component:\"span\",endIcon:/*#__PURE__*/React.createElement(PhotoCamera,null)},\"A\\xF1adir imagen\")),imagesLoading?/*#__PURE__*/React.createElement(Grid,{container:true,spacing:2},photos.map(function(img){return/*#__PURE__*/React.createElement(Grid,{item:true,xs:4},/*#__PURE__*/React.createElement(DisplayImages,{img:img}));})):/*#__PURE__*/React.createElement(\"div\",null,\"Recuperando im\\xE1genes de su restaurante...\"));};export default UploadImages;","map":{"version":3,"sources":["/home/chiara/repos/arquiweb-tp1/react-frontend/src/screens/RestaurantManagement/UploadImages/index.js"],"names":["React","useState","useEffect","DisplayImages","Grid","Button","PhotoCamera","UploadImages","restaurantId","dataUri","setDataUri","statusError","setStatusError","imagesLoading","setImagesLoading","photos","setPhotos","fileToDataUri","file","Promise","resolve","reject","reader","FileReader","onload","event","target","result","readAsDataURL","fetchImages","imageId","fetch","then","response","blob","image","localUrl","URL","createObjectURL","url","id","json","imageIds","map","onChange","data","FormData","append","method","body","res","window","location","reload","display","files","img"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport DisplayImages from \"../DisplayImages\";\nimport Grid from '@mui/material/Grid';\nimport Button from '@mui/material/Button';\nimport PhotoCamera from '@mui/icons-material/PhotoCamera';\n\n\n\nconst UploadImages = ({\n    restaurantId\n}) => {\n\n    const [dataUri, setDataUri] = useState('');\n    const [statusError, setStatusError] = useState(false);\n    const [imagesLoading, setImagesLoading] = useState(false);\n    const [photos, setPhotos] = useState([]);\n\n    const fileToDataUri = (file) => new Promise((resolve, reject) => {\n        const reader = new FileReader();\n        reader.onload = (event) => {\n            resolve(event.target.result)\n        };\n        reader.readAsDataURL(file);\n    })\n\n    useEffect(() => {\n\n        const fetchImages = imageId => {\n            fetch(`https://ver-la-carta.herokuapp.com/imagen/${imageId}`)\n                .then(response => response.blob())\n                .then(image => {\n                    // Create a local URL of that image\n                    const localUrl = URL.createObjectURL(image);\n                    setPhotos(photos => [...photos, { url: localUrl, id: imageId }]);\n                    setImagesLoading(true);\n                });\n        }\n\n        fetch(`https://ver-la-carta.herokuapp.com/imagen/resto/${restaurantId}`)\n            .then(response => response.json())\n            .then(imageIds => {\n                imageIds.map(fetchImages)\n            });\n    }, []);\n\n\n    const onChange = (file) => {\n\n        if (!file) {\n            setDataUri('');\n            return;\n        }\n\n        fileToDataUri(file)\n            .then(dataUri => {\n                setDataUri(dataUri);\n            });\n\n        const data = new FormData()\n        data.append('file', file)\n\n        fetch(`https://ver-la-carta.herokuapp.com/imagen/${restaurantId}`, {\n            method: \"POST\",\n            body: data\n        })\n            .then(res => res.json())\n            .then(data => { })\n        window.location.reload()\n\n    }\n\n    return (\n\n            <div>\n                <label htmlFor=\"upload-photo\">\n                    <input\n                        style={{ display: 'none' }}\n                        id=\"upload-photo\"\n                        name=\"upload-photo\"\n                        type=\"file\"\n                        onChange={(event) => onChange(event.target.files[0] || null)}\n                    />\n                    <Button variant=\"contained\" component=\"span\" endIcon={<PhotoCamera />}>\n                        Añadir imagen\n                    </Button>\n                </label>\n\n                {imagesLoading ? (\n                    <Grid container spacing={2}>\n                        {photos.map(img => (\n                            <Grid item xs={4}>\n                                <DisplayImages\n                                    img={img}\n                                />\n                            </Grid>\n                        ))}\n                    </Grid>\n                ) : (\n                    <div>Recuperando imágenes de su restaurante...</div>\n                )}\n                \n            </div>\n\n    );\n};\n\nexport default UploadImages"]},"metadata":{},"sourceType":"module"}