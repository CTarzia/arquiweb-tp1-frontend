{"ast":null,"code":"import _defineProperty from \"/home/widergy/Documents/Guido/UBA/arqweb/verLaCartaFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/home/widergy/Documents/Guido/UBA/arqweb/verLaCartaFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"/home/widergy/Documents/Guido/UBA/arqweb/verLaCartaFront/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"/home/widergy/Documents/Guido/UBA/arqweb/verLaCartaFront/src/screens/CreateOrder/index.js\";\n\nimport React, { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router\";\nimport { useLocation } from \"react-router-dom\";\nimport GoBackButton from \"../../components/GoBack\";\nimport { apiGet, apiPost } from \"../../utils/services\";\nimport { ROUTES } from \"../../constants/routes\";\nimport styles from \"./styles.module.scss\";\nimport PostOrder from \"./components/PostOrder\";\nimport { Typography } from \"@mui/material\";\n\nvar CreateOrder = function CreateOrder() {\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      restaurantName = _useState2[0],\n      setRestaurantName = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      statusError = _useState4[0],\n      setStatusError = _useState4[1];\n\n  var _useState5 = useState({}),\n      _useState6 = _slicedToArray(_useState5, 2),\n      order = _useState6[0],\n      setOrder = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      restaurantLoading = _useState8[0],\n      setRestaurantLoading = _useState8[1];\n\n  var _useState9 = useState(true),\n      _useState10 = _slicedToArray(_useState9, 2),\n      orderLoading = _useState10[0],\n      setOrderLoading = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      orderTaken = _useState12[0],\n      setOrderTaken = _useState12[1];\n\n  var _useState13 = useState(),\n      _useState14 = _slicedToArray(_useState13, 2),\n      orderStatus = _useState14[0],\n      setOrderStatus = _useState14[1];\n\n  var _useParams = useParams(),\n      restaurantId = _useParams.id;\n\n  var search = useLocation().search;\n  var tableNumber = new URLSearchParams(search).get('mesa');\n  useEffect(function () {\n    fetch(\"https://ver-la-carta.herokuapp.com/restaurantes/\".concat(restaurantId)).then(function (res) {\n      return res.json();\n    }).then(function (json) {\n      if (json.status === 404) {\n        setStatusError(true);\n        setRestaurantName(\"Su restaurante no ha sido encontrado.\");\n      } else {\n        setRestaurantName(json.name);\n        setRestaurantLoading(true);\n      }\n    });\n    fetch(\"https://ver-la-carta.herokuapp.com/mesas/\".concat(restaurantId, \"/\").concat(tableNumber)).then(function (res) {\n      return res.json();\n    }).then(function (json) {\n      console.log(orderTaken);\n\n      if (json.status) {\n        setOrderTaken(json.status);\n      }\n    });\n  }, []);\n\n  var handleOnInputChange = function handleOnInputChange(evt) {\n    setOrder(_objectSpread(_objectSpread({}, order), {}, _defineProperty({}, evt.target.name, evt.target.value)));\n  };\n\n  var handleSubmit = function handleSubmit(evt) {\n    evt.preventDefault();\n    setOrderLoading(false);\n\n    if (!orderTaken) {\n      var type = tableNumber ? \"table\" : \"client\";\n      var orderToSend = order;\n\n      if (tableNumber) {\n        orderToSend = _objectSpread(_objectSpread({}, order), {}, {\n          tableNumber: tableNumber\n        });\n      }\n\n      ;\n      console.log(typeof orderTaken);\n      fetch(\"https://ver-la-carta.herokuapp.com/orders/\".concat(type, \"/\").concat(restaurantId), {\n        method: \"POST\",\n        body: JSON.stringify(orderToSend),\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      }).then(function (res) {\n        return res.json();\n      }).then(function (json) {\n        setOrderLoading(true);\n\n        if (tableNumber) {\n          window.alert(\"Su pedido ha sido enviado.\");\n        } else {\n          window.alert(\"Su pedido ha sido enviado. Su n\\xFAmero de pedido es: \".concat(json, \".\"));\n        }\n      });\n      fetch(\"https://ver-la-carta.herokuapp.com/mesas/\".concat(restaurantId, \"/\").concat(tableNumber, \"/status\"), {\n        method: \"PUT\",\n        body: JSON.stringify({}),\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      });\n    } else {\n      setOrderLoading(true);\n      window.alert(\"no puede realizar mas de un pedido\");\n    }\n\n    window.location.reload();\n  };\n\n  return !statusError ? restaurantLoading ? orderLoading ? /*#__PURE__*/React.createElement(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: styles.titleContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    variant: \"h3\",\n    component: \"h1\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 8\n    }\n  }, restaurantName), /*#__PURE__*/React.createElement(GoBackButton, {\n    route: ROUTES.NEARBY_RESTAURANTS,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 8\n    }\n  })), /*#__PURE__*/React.createElement(PostOrder, {\n    handleSubmit: handleSubmit,\n    handleOnInputChange: handleOnInputChange,\n    tableNumber: tableNumber,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }\n  })) : /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 10\n    }\n  }, \"Enviando su pedido.\") : /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 5\n    }\n  }, \"Recuperando informaci\\xF3n del restaurante.\") : /*#__PURE__*/React.createElement(\"p\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 4\n    }\n  }, \"Ha ocurrido un error.\");\n};\n\nexport default CreateOrder;","map":{"version":3,"sources":["/home/widergy/Documents/Guido/UBA/arqweb/verLaCartaFront/src/screens/CreateOrder/index.js"],"names":["React","useState","useEffect","useParams","useLocation","GoBackButton","apiGet","apiPost","ROUTES","styles","PostOrder","Typography","CreateOrder","restaurantName","setRestaurantName","statusError","setStatusError","order","setOrder","restaurantLoading","setRestaurantLoading","orderLoading","setOrderLoading","orderTaken","setOrderTaken","orderStatus","setOrderStatus","restaurantId","id","search","tableNumber","URLSearchParams","get","fetch","then","res","json","status","name","console","log","handleOnInputChange","evt","target","value","handleSubmit","preventDefault","type","orderToSend","method","body","JSON","stringify","headers","window","alert","location","reload","titleContainer","NEARBY_RESTAURANTS"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router\";\nimport { useLocation } from \"react-router-dom\";\n\nimport GoBackButton from \"../../components/GoBack\";\nimport { apiGet, apiPost } from \"../../utils/services\";\nimport { ROUTES } from \"../../constants/routes\";\n\nimport styles from \"./styles.module.scss\";\nimport PostOrder from \"./components/PostOrder\";\nimport { Typography } from \"@mui/material\";\n\nconst CreateOrder = () => {\n\tconst [restaurantName, setRestaurantName] = useState();\n\tconst [statusError, setStatusError] = useState(false);\n\tconst [order, setOrder] = useState({});\n\tconst [restaurantLoading, setRestaurantLoading] = useState(false);\n\tconst [orderLoading, setOrderLoading] = useState(true);\n\tconst [orderTaken, setOrderTaken] = useState(false);\n\tconst [orderStatus, setOrderStatus] = useState();\n\n\tconst { id: restaurantId } = useParams();\n\tconst search = useLocation().search;\n\tconst tableNumber = new URLSearchParams(search).get('mesa');\n\n\n\tuseEffect(() => {\n\t\tfetch(`https://ver-la-carta.herokuapp.com/restaurantes/${restaurantId}`)\n\t\t.then((res) => res.json())\n\t\t.then((json) => {\n\t\t\tif (json.status === 404) {\n\t\t\t\tsetStatusError(true);\n\t\t\t\tsetRestaurantName(\"Su restaurante no ha sido encontrado.\");\n\t\t\t} else {\n\t\t\t\tsetRestaurantName(json.name);\n\t\t\t\tsetRestaurantLoading(true)\n\t\t\t}\n\t\t});\n\t\tfetch(`https://ver-la-carta.herokuapp.com/mesas/${restaurantId}/${tableNumber}`)\n\t\t.then((res) => res.json())\n\t\t.then((json) => {\n\t\t\tconsole.log(orderTaken);\n\t\t\tif (json.status) {\n\t\t\t\tsetOrderTaken(json.status);\n\t\t\t}\n\t\t});\n\t}, []);\n\n\tconst handleOnInputChange = (evt) => {\n\t\tsetOrder({ ...order, [evt.target.name]: evt.target.value });\n\t};\n\n\tconst handleSubmit = (evt) => {\n\t\tevt.preventDefault()\n\t\tsetOrderLoading(false)\n\n\t\tif(!orderTaken){\n\t\t\tconst type = (tableNumber) ? (\"table\") : (\"client\")\n\t\t\tlet orderToSend = order\n\t\t\tif (tableNumber) {\n\t\t\t\torderToSend = { ...order, tableNumber }\n\t\t\t};\n\t\t\tconsole.log(typeof(orderTaken));\n\t\t\tfetch(`https://ver-la-carta.herokuapp.com/orders/${type}/${restaurantId}`, {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tbody: JSON.stringify(orderToSend),\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t},\n\t\t\t})\n\t\t\t.then((res) => res.json())\n\t\t\t.then((json) => {\n\t\t\t\tsetOrderLoading(true)\n\t\t\t\tif (tableNumber) {\n\t\t\t\t\twindow.alert(`Su pedido ha sido enviado.`);\n\t\t\t\t} else {\n\t\t\t\t\twindow.alert(`Su pedido ha sido enviado. Su número de pedido es: ${json}.`);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfetch(`https://ver-la-carta.herokuapp.com/mesas/${restaurantId}/${tableNumber}/status`, {\n\t\t\t\tmethod: \"PUT\",\n\t\t\t\tbody: JSON.stringify({}),\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t},\n\t\t\t});\n\t\t}else{\n\t\t\tsetOrderLoading(true);\n\t\t\twindow.alert(`no puede realizar mas de un pedido`);\n\t\t}\n\t\twindow.location.reload();\n\t};\n\n\treturn (\n\t\t!statusError ? (\n\t\t\trestaurantLoading ? (\n\t\t\t\torderLoading ? (\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div className={styles.titleContainer}>\n\t\t\t\t\t\t\t<Typography variant=\"h3\" component=\"h1\">{restaurantName}</Typography>\n\t\t\t\t\t\t\t<GoBackButton route={ROUTES.NEARBY_RESTAURANTS} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<PostOrder\n\t\t\t\t\t\t\thandleSubmit={handleSubmit}\n\t\t\t\t\t\t\thandleOnInputChange={handleOnInputChange}\n\t\t\t\t\t\t\ttableNumber={tableNumber}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\n\t\t\t\t) : (<p>Enviando su pedido.</p>)\n\n\t\t\t) : (\n\t\t\t\t<p>Recuperando información del restaurante.</p>\n\t\t\t)\n\t\t) : (\n\t\t\t<p>Ha ocurrido un error.</p>\n\t\t)\n\n\n\t);\n};\nexport default CreateOrder;"]},"metadata":{},"sourceType":"module"}