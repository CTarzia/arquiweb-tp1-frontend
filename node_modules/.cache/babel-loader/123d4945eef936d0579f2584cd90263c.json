{"ast":null,"code":"import _slicedToArray from\"/home/chiara/repos/arquiweb-tp1/react-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useParams}from\"react-router\";import styles from\"./styles.module.scss\";import{CardMedia}from\"@mui/material\";import{ROUTES}from\"../../constants/routes\";import Topbar from\"../../components/Topbar\";import{useLocation}from\"react-router-dom\";import{Link}from\"react-router-dom\";var Menu=function Menu(_ref){var history=_ref.history;var _useState=useState(),_useState2=_slicedToArray(_useState,2),menuUrl=_useState2[0],setMenuUrl=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),canPickup=_useState4[0],setCanPickup=_useState4[1];var _useParams=useParams(),restaurantId=_useParams.restoId;var search=useLocation().search;var tableId=new URLSearchParams(search).get(\"mesa\");var appId=parseInt(new URLSearchParams(search).get(\"appId\"));useEffect(function(){switch(appId){case 1:fetch(\"https://ver-la-carta.herokuapp.com/carta/\".concat(restaurantId)).then(function(response){if(response.status===404){return\"error\";}return response.blob();}).then(function(image){if(image!==\"error\"){var localUrl=URL.createObjectURL(image);setMenuUrl(localUrl);}});break;case 2:fetch(\"https://arquiweb-tp1.herokuapp.com/api/restaurants\",{}).then(function(res){return res.json();}).catch(function(error){return console.log(error);}).then(function(json){var restaurant=json.items.find(function(res){return res.id==restaurantId;});setCanPickup(restaurant.has_pickup);setMenuUrl(restaurant.menu_link);if(restaurant){}else{window.alert(\"hubo un error al recuperar su menu\");history.push(ROUTES.NEARBY_RESTAURANTS);}});break;case 3:fetch(\"http://moorfy.com:5000/clients/branches\",{}).then(function(res){return res.json();}).catch(function(error){return console.log(error);}).then(function(json){var restaurant=json.find(function(res){return res.branch_id==restaurantId;});setMenuUrl(restaurant.menu_url);});break;default:window.alert(\"hubo un error al recuperar su menu\");history.push(ROUTES.NEARBY_RESTAURANTS);break;}},[]);var callServer=function callServer(){fetch(\"https://ver-la-carta.herokuapp.com/mesas/\".concat(restaurantId,\"/\").concat(tableId,\"/call\"),{method:\"POST\",body:JSON.stringify({}),headers:{\"Content-Type\":\"application/json\"}}).then(function(res){return res.json();}).then(function(json){window.alert(\"Mesero en camino!\");});};return/*#__PURE__*/React.createElement(\"div\",{className:styles.container},/*#__PURE__*/React.createElement(Topbar,{returnRoute:ROUTES.NEARBY_RESTAURANTS,title:\"Menu\"}),/*#__PURE__*/React.createElement(\"div\",{className:styles.content},menuUrl&&/*#__PURE__*/React.createElement(CardMedia,{component:\"img\",classes:{root:styles.image},image:menuUrl,alt:\"img reastaurant\"})),/*#__PURE__*/React.createElement(\"div\",{className:styles.buttons},canPickup&&/*#__PURE__*/React.createElement(Link,{to:tableId?\"/restaurante/\".concat(restaurantId,\"/hacer_pedido?mesa=\").concat(tableId):\"/restaurante/\".concat(restaurantId,\"/hacer_pedido\")},/*#__PURE__*/React.createElement(\"button\",{className:styles.button},\"Hacer pedido\")),tableId&&/*#__PURE__*/React.createElement(\"button\",{className:styles.button,onClick:callServer},\"LLamar al mozo\")));};export default Menu;","map":{"version":3,"sources":["/home/chiara/repos/arquiweb-tp1/react-frontend/src/screens/Menu/index.js"],"names":["React","useState","useEffect","useParams","styles","CardMedia","ROUTES","Topbar","useLocation","Link","Menu","history","menuUrl","setMenuUrl","canPickup","setCanPickup","restaurantId","restoId","search","tableId","URLSearchParams","get","appId","parseInt","fetch","then","response","status","blob","image","localUrl","URL","createObjectURL","res","json","catch","error","console","log","restaurant","items","find","id","has_pickup","menu_link","window","alert","push","NEARBY_RESTAURANTS","branch_id","menu_url","callServer","method","body","JSON","stringify","headers","container","content","root","buttons","button"],"mappings":"qKAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,OAASC,SAAT,KAA0B,cAA1B,CACA,MAAOC,CAAAA,MAAP,KAAmB,sBAAnB,CACA,OAASC,SAAT,KAA0B,eAA1B,CACA,OAASC,MAAT,KAAuB,wBAAvB,CACA,MAAOC,CAAAA,MAAP,KAAmB,yBAAnB,CACA,OAASC,WAAT,KAA4B,kBAA5B,CACA,OAASC,IAAT,KAAqB,kBAArB,CAEA,GAAMC,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,MAAiB,IAAdC,CAAAA,OAAc,MAAdA,OAAc,CAC7B,cAA8BV,QAAQ,EAAtC,wCAAOW,OAAP,eAAgBC,UAAhB,eACA,eAAkCZ,QAAQ,CAAC,IAAD,CAA1C,yCAAOa,SAAP,eAAkBC,YAAlB,eAEA,eAAkCZ,SAAS,EAA3C,CAAiBa,YAAjB,YAAQC,OAAR,CACA,GAAMC,CAAAA,MAAM,CAAGV,WAAW,GAAGU,MAA7B,CACA,GAAMC,CAAAA,OAAO,CAAG,GAAIC,CAAAA,eAAJ,CAAoBF,MAApB,EAA4BG,GAA5B,CAAgC,MAAhC,CAAhB,CACA,GAAMC,CAAAA,KAAK,CAAGC,QAAQ,CAAC,GAAIH,CAAAA,eAAJ,CAAoBF,MAApB,EAA4BG,GAA5B,CAAgC,OAAhC,CAAD,CAAtB,CAEAnB,SAAS,CAAC,UAAM,CACf,OAAQoB,KAAR,EACC,IAAK,EAAL,CACCE,KAAK,oDAA6CR,YAA7C,EAAL,CACES,IADF,CACO,SAACC,QAAD,CAAc,CACnB,GAAIA,QAAQ,CAACC,MAAT,GAAoB,GAAxB,CAA6B,CAC5B,MAAO,OAAP,CACA,CACD,MAAOD,CAAAA,QAAQ,CAACE,IAAT,EAAP,CACA,CANF,EAOEH,IAPF,CAOO,SAACI,KAAD,CAAW,CAChB,GAAIA,KAAK,GAAK,OAAd,CAAuB,CACtB,GAAMC,CAAAA,QAAQ,CAAGC,GAAG,CAACC,eAAJ,CAAoBH,KAApB,CAAjB,CACAhB,UAAU,CAACiB,QAAD,CAAV,CACA,CACD,CAZF,EAaA,MACD,IAAK,EAAL,CACCN,KAAK,CAAC,oDAAD,CAAuD,EAAvD,CAAL,CACEC,IADF,CACO,SAACQ,GAAD,QAASA,CAAAA,GAAG,CAACC,IAAJ,EAAT,EADP,EAEEC,KAFF,CAEQ,SAACC,KAAD,QAAWC,CAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAAX,EAFR,EAGEX,IAHF,CAGO,SAACS,IAAD,CAAU,CACf,GAAMK,CAAAA,UAAU,CAAGL,IAAI,CAACM,KAAL,CAAWC,IAAX,CAAgB,SAACR,GAAD,QAASA,CAAAA,GAAG,CAACS,EAAJ,EAAU1B,YAAnB,EAAhB,CAAnB,CACAD,YAAY,CAACwB,UAAU,CAACI,UAAZ,CAAZ,CACA9B,UAAU,CAAC0B,UAAU,CAACK,SAAZ,CAAV,CACA,GAAIL,UAAJ,CAAgB,CACf,CADD,IACO,CACNM,MAAM,CAACC,KAAP,CAAa,oCAAb,EACAnC,OAAO,CAACoC,IAAR,CAAazC,MAAM,CAAC0C,kBAApB,EACA,CACD,CAZF,EAaA,MACD,IAAK,EAAL,CACCxB,KAAK,CAAC,yCAAD,CAA4C,EAA5C,CAAL,CACEC,IADF,CACO,SAACQ,GAAD,QAASA,CAAAA,GAAG,CAACC,IAAJ,EAAT,EADP,EAEEC,KAFF,CAEQ,SAACC,KAAD,QAAWC,CAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAAX,EAFR,EAGEX,IAHF,CAGO,SAACS,IAAD,CAAU,CACf,GAAMK,CAAAA,UAAU,CAAGL,IAAI,CAACO,IAAL,CAClB,SAACR,GAAD,QAASA,CAAAA,GAAG,CAACgB,SAAJ,EAAiBjC,YAA1B,EADkB,CAAnB,CAGAH,UAAU,CAAC0B,UAAU,CAACW,QAAZ,CAAV,CACA,CARF,EASA,MACD,QACCL,MAAM,CAACC,KAAP,CAAa,oCAAb,EACAnC,OAAO,CAACoC,IAAR,CAAazC,MAAM,CAAC0C,kBAApB,EACA,MA7CF,CA+CA,CAhDQ,CAgDN,EAhDM,CAAT,CAkDA,GAAMG,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACxB3B,KAAK,oDACwCR,YADxC,aACwDG,OADxD,UAEJ,CACCiC,MAAM,CAAE,MADT,CAECC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe,EAAf,CAFP,CAGCC,OAAO,CAAE,CACR,eAAgB,kBADR,CAHV,CAFI,CAAL,CAUE/B,IAVF,CAUO,SAACQ,GAAD,QAASA,CAAAA,GAAG,CAACC,IAAJ,EAAT,EAVP,EAWET,IAXF,CAWO,SAACS,IAAD,CAAU,CACfW,MAAM,CAACC,KAAP,CAAa,mBAAb,EACA,CAbF,EAcA,CAfD,CAiBA,mBACC,2BAAK,SAAS,CAAE1C,MAAM,CAACqD,SAAvB,eACC,oBAAC,MAAD,EAAQ,WAAW,CAAEnD,MAAM,CAAC0C,kBAA5B,CAAgD,KAAK,CAAC,MAAtD,EADD,cAEC,2BAAK,SAAS,CAAE5C,MAAM,CAACsD,OAAvB,EACE9C,OAAO,eACP,oBAAC,SAAD,EACC,SAAS,CAAC,KADX,CAEC,OAAO,CAAE,CAAE+C,IAAI,CAAEvD,MAAM,CAACyB,KAAf,CAFV,CAGC,KAAK,CAAEjB,OAHR,CAIC,GAAG,CAAC,iBAJL,EAFF,CAFD,cAYC,2BAAK,SAAS,CAAER,MAAM,CAACwD,OAAvB,EACE9C,SAAS,eACT,oBAAC,IAAD,EACC,EAAE,CACDK,OAAO,wBACYH,YADZ,+BAC8CG,OAD9C,yBAEYH,YAFZ,iBAFT,eAOC,8BAAQ,SAAS,CAAEZ,MAAM,CAACyD,MAA1B,iBAPD,CAFF,CAYE1C,OAAO,eACP,8BAAQ,SAAS,CAAEf,MAAM,CAACyD,MAA1B,CAAkC,OAAO,CAAEV,UAA3C,mBAbF,CAZD,CADD,CAiCA,CA7GD,CA+GA,cAAezC,CAAAA,IAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useParams } from \"react-router\";\nimport styles from \"./styles.module.scss\";\nimport { CardMedia } from \"@mui/material\";\nimport { ROUTES } from \"../../constants/routes\";\nimport Topbar from \"../../components/Topbar\";\nimport { useLocation } from \"react-router-dom\";\nimport { Link } from \"react-router-dom\";\n\nconst Menu = ({ history }) => {\n\tconst [menuUrl, setMenuUrl] = useState();\n\tconst [canPickup, setCanPickup] = useState(true);\n\n\tconst { restoId: restaurantId } = useParams();\n\tconst search = useLocation().search;\n\tconst tableId = new URLSearchParams(search).get(\"mesa\");\n\tconst appId = parseInt(new URLSearchParams(search).get(\"appId\"));\n\n\tuseEffect(() => {\n\t\tswitch (appId) {\n\t\t\tcase 1:\n\t\t\t\tfetch(`https://ver-la-carta.herokuapp.com/carta/${restaurantId}`)\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tif (response.status === 404) {\n\t\t\t\t\t\t\treturn \"error\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn response.blob();\n\t\t\t\t\t})\n\t\t\t\t\t.then((image) => {\n\t\t\t\t\t\tif (image !== \"error\") {\n\t\t\t\t\t\t\tconst localUrl = URL.createObjectURL(image);\n\t\t\t\t\t\t\tsetMenuUrl(localUrl);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tfetch(\"https://arquiweb-tp1.herokuapp.com/api/restaurants\", {})\n\t\t\t\t\t.then((res) => res.json())\n\t\t\t\t\t.catch((error) => console.log(error))\n\t\t\t\t\t.then((json) => {\n\t\t\t\t\t\tconst restaurant = json.items.find((res) => res.id == restaurantId);\n\t\t\t\t\t\tsetCanPickup(restaurant.has_pickup);\n\t\t\t\t\t\tsetMenuUrl(restaurant.menu_link);\n\t\t\t\t\t\tif (restaurant) {\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\twindow.alert(\"hubo un error al recuperar su menu\");\n\t\t\t\t\t\t\thistory.push(ROUTES.NEARBY_RESTAURANTS);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tfetch(\"http://moorfy.com:5000/clients/branches\", {})\n\t\t\t\t\t.then((res) => res.json())\n\t\t\t\t\t.catch((error) => console.log(error))\n\t\t\t\t\t.then((json) => {\n\t\t\t\t\t\tconst restaurant = json.find(\n\t\t\t\t\t\t\t(res) => res.branch_id == restaurantId\n\t\t\t\t\t\t);\n\t\t\t\t\t\tsetMenuUrl(restaurant.menu_url);\n\t\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\twindow.alert(\"hubo un error al recuperar su menu\");\n\t\t\t\thistory.push(ROUTES.NEARBY_RESTAURANTS);\n\t\t\t\tbreak;\n\t\t}\n\t}, []);\n\n\tconst callServer = () => {\n\t\tfetch(\n\t\t\t`https://ver-la-carta.herokuapp.com/mesas/${restaurantId}/${tableId}/call`,\n\t\t\t{\n\t\t\t\tmethod: \"POST\",\n\t\t\t\tbody: JSON.stringify({}),\n\t\t\t\theaders: {\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t},\n\t\t\t}\n\t\t)\n\t\t\t.then((res) => res.json())\n\t\t\t.then((json) => {\n\t\t\t\twindow.alert(\"Mesero en camino!\");\n\t\t\t});\n\t};\n\n\treturn (\n\t\t<div className={styles.container}>\n\t\t\t<Topbar returnRoute={ROUTES.NEARBY_RESTAURANTS} title=\"Menu\" />\n\t\t\t<div className={styles.content}>\n\t\t\t\t{menuUrl && (\n\t\t\t\t\t<CardMedia\n\t\t\t\t\t\tcomponent=\"img\"\n\t\t\t\t\t\tclasses={{ root: styles.image }}\n\t\t\t\t\t\timage={menuUrl}\n\t\t\t\t\t\talt=\"img reastaurant\"\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t\t<div className={styles.buttons}>\n\t\t\t\t{canPickup && (\n\t\t\t\t\t<Link\n\t\t\t\t\t\tto={\n\t\t\t\t\t\t\ttableId\n\t\t\t\t\t\t\t\t? `/restaurante/${restaurantId}/hacer_pedido?mesa=${tableId}`\n\t\t\t\t\t\t\t\t: `/restaurante/${restaurantId}/hacer_pedido`\n\t\t\t\t\t\t}\n\t\t\t\t\t>\n\t\t\t\t\t\t<button className={styles.button}>Hacer pedido</button>\n\t\t\t\t\t</Link>\n\t\t\t\t)}\n\t\t\t\t{tableId && (\n\t\t\t\t\t<button className={styles.button} onClick={callServer}>\n\t\t\t\t\t\tLLamar al mozo\n\t\t\t\t\t</button>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default Menu;\n"]},"metadata":{},"sourceType":"module"}